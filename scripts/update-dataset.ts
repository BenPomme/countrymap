import fs from 'fs'

// Read current countries data
const countriesData = JSON.parse(fs.readFileSync('data/countries.json', 'utf8'))

// Country name mapping to handle variations
const countryNameMap: Record<string, string> = {
  'United States': 'United States',
  'USA': 'United States',
  'U.S.': 'United States',
  'US': 'United States',
  'United Kingdom': 'United Kingdom',
  'UK': 'United Kingdom',
  'South Korea': 'South Korea',
  'Korea, South': 'South Korea',
  'Republic of Korea': 'South Korea',
  'North Korea': 'North Korea',
  'Korea, North': 'North Korea',
  'Czech Republic': 'Czechia',
  'Czechia': 'Czechia',
  'Ivory Coast': "Cote d'Ivoire",
  "Cote d'Ivoire": "Cote d'Ivoire",
  'DR Congo': 'Democratic Republic of the Congo',
  'Democratic Republic of the Congo': 'Democratic Republic of the Congo',
  'DRC': 'Democratic Republic of the Congo',
  'Congo': 'Republic of the Congo',
  'Republic of Congo': 'Republic of the Congo',
  'Republic of the Congo': 'Republic of the Congo',
  'UAE': 'United Arab Emirates',
  'United Arab Emirates': 'United Arab Emirates',
  'Russia': 'Russia',
  'Russian Federation': 'Russia',
  'Taiwan': 'Taiwan',
  'Chinese Taipei': 'Taiwan',
  'China': 'China',
  'Mainland China': 'China',
  'Hong Kong': 'Hong Kong',
  'Hong Kong (China)': 'Hong Kong',
  'China, Hong Kong SAR': 'Hong Kong',
  'Trinidad And Tobago': 'Trinidad and Tobago',
  'Trinidad & Tobago': 'Trinidad and Tobago',
  'Bosnia And Herzegovina': 'Bosnia and Herzegovina',
  'Bosnia & Herzegovina': 'Bosnia and Herzegovina',
  'Saint Vincent & Grenadines': 'Saint Vincent and the Grenadines',
  'São Tomé & Príncipe': 'Sao Tome and Principe',
  'Cape Verde': 'Cabo Verde',
  'Antigua & Barbuda': 'Antigua and Barbuda',
  'Macau': 'Macao',
  'Macao': 'Macao',
  'Palestine': 'Palestine',
  'Palestinian Territories': 'Palestine',
  'North Macedonia': 'North Macedonia',
  'Macedonia': 'North Macedonia',
  'Eswatini': 'Eswatini',
  'Swaziland': 'Eswatini',
}

function normalizeCountryName(name: string): string {
  return countryNameMap[name] || name
}

function findCountry(countries: any[], name: string): any | null {
  const normalized = normalizeCountryName(name)
  return countries.find((c: any) => {
    const countryName = c.name.toLowerCase()
    const searchName = normalized.toLowerCase()
    return countryName === searchName ||
           countryName.includes(searchName) ||
           searchName.includes(countryName)
  })
}

// New homicide rate data (per 100,000)
const homicideRates: Record<string, number> = {
  'Jamaica': 49.3,
  'Ecuador': 45.7,
  'Haiti': 41.1,
  'Honduras': 31.4,
  'Mexico': 24.9,
  'Costa Rica': 17.8,
  'Puerto Rico': 14.3,
  'Mongolia': 5.92,
  'United States': 5.76,
  'Bolivia': 4.37,
  'Pakistan': 4.33,
  'Turkey': 3.23,
  'Lithuania': 2.63,
  'Moldova': 2.54,
  'Latvia': 2.5,
  'Morocco': 1.71,
  'Estonia': 1.54,
  'North Macedonia': 1.53,
  'Albania': 1.39,
  'France': 1.34,
  'Serbia': 1.31,
  'Bosnia and Herzegovina': 1.22,
  'Algeria': 1.16,
  'Sweden': 1.15,
  'Slovakia': 1.12,
  'Romania': 1.11,
  'Bulgaria': 1.09,
  'Jordan': 0.99,
  'Finland': 0.98,
  'Austria': 0.88,
  'Australia': 0.85,
  'Greece': 0.84,
  'Cyprus': 0.82,
  'Poland': 0.8,
  'Montenegro': 0.79,
  'Czechia': 0.77,
  'Hungary': 0.77,
  'Norway': 0.72,
  'Spain': 0.69,
  'Netherlands': 0.69,
  'Ireland': 0.65,
  'Switzerland': 0.6,
  'Slovenia': 0.57,
  'Malta': 0.56,
  'Zimbabwe': 0.51,
  'Oman': 0.14,
  'Singapore': 0.07,
  // Additional data from UNODC
  'El Salvador': 7.8,
  'Brazil': 21.0,
  'South Africa': 41.0,
  'Colombia': 26.0,
  'Venezuela': 36.0,
  'Guatemala': 17.0,
  'Trinidad and Tobago': 28.0,
  'Russia': 4.5,
  'Philippines': 4.1,
  'India': 2.9,
  'China': 0.5,
  'Japan': 0.3,
  'Germany': 0.8,
  'Canada': 2.0,
  'Italy': 0.5,
  'Argentina': 4.5,
  'Chile': 4.5,
  'Peru': 7.5,
  'Nigeria': 9.0,
  'Kenya': 4.5,
  'Thailand': 3.0,
  'Indonesia': 0.4,
  'Malaysia': 1.5,
  'Vietnam': 1.5,
  'Egypt': 2.0,
  'Saudi Arabia': 1.1,
  'United Arab Emirates': 0.5,
  'Israel': 1.5,
  'Ukraine': 4.0,
  'Bangladesh': 2.6,
  'Nepal': 2.0,
  'Sri Lanka': 2.3,
  'New Zealand': 0.7,
  'Portugal': 0.8,
  'Belgium': 1.7,
  'Denmark': 0.8,
  'Croatia': 0.8,
  'Iceland': 0.3,
  'Luxembourg': 0.4,
}

// Safety Index data (Numbeo 2025)
const safetyIndex: Record<string, number> = {
  'Venezuela': 19.30,
  'Papua New Guinea': 19.70,
  'Haiti': 21.13,
  'Afghanistan': 24.92,
  'South Africa': 25.33,
  'Honduras': 28.04,
  'Trinidad and Tobago': 29.11,
  'Syria': 31.86,
  'Jamaica': 32.56,
  'Peru': 32.88,
  'Nigeria': 33.44,
  'Guyana': 33.65,
  'Angola': 33.71,
  'Cameroon': 34.53,
  'Bolivia': 35.00,
  'Brazil': 35.47,
  'Somalia': 36.08,
  'Yemen': 36.27,
  'Namibia': 36.51,
  'Argentina': 36.62,
  'Ecuador': 37.50,
  'Bangladesh': 38.44,
  'Colombia': 39.14,
  'Zimbabwe': 39.31,
  'Dominican Republic': 39.46,
  'Chile': 39.52,
  'Mozambique': 39.89,
  'Paraguay': 40.18,
  'El Salvador': 41.39,
  'Guatemala': 42.33,
  'Bahamas': 43.10,
  'Fiji': 43.44,
  "Cote d'Ivoire": 43.57,
  'Libya': 43.58,
  'Kenya': 44.04,
  'France': 44.59,
  'Kyrgyzstan': 45.67,
  'Maldives': 45.87,
  'Uganda': 45.88,
  'Costa Rica': 45.90,
  'Tanzania': 46.46,
  'Mexico': 46.57,
  'Belize': 47.26,
  'Botswana': 47.30,
  'Algeria': 47.39,
  'Mongolia': 47.94,
  'Uruguay': 48.01,
  'Cambodia': 48.67,
  'Myanmar': 49.14,
  'Nicaragua': 49.25,
  'Ethiopia': 49.30,
  'Iran': 49.50,
  'Mauritius': 49.97,
  'Belarus': 50.24,
  'Belgium': 50.58,
  'United States': 50.78,
  'Malaysia': 51.13,
  'United Kingdom': 51.72,
  'New Zealand': 51.82,
  'Sweden': 51.97,
  'Morocco': 52.17,
  'Ireland': 52.41,
  'Egypt': 52.71,
  'Australia': 52.72,
  'Ukraine': 53.00,
  'Italy': 53.05,
  'Lebanon': 53.16,
  'Greece': 53.62,
  'Indonesia': 54.05,
  'Canada': 54.29,
  'Zambia': 54.39,
  'Sudan': 54.50,
  'Ghana': 54.65,
  'Kazakhstan': 54.85,
  'Tunisia': 54.91,
  'Barbados': 55.14,
  'Albania': 55.31,
  'India': 55.70,
  'Moldova': 55.73,
  'Pakistan': 56.25,
  'Philippines': 56.87,
  'Iraq': 56.91,
  'Malta': 57.04,
  'Palestine': 57.24,
  'Panama': 57.32,
  'Sri Lanka': 57.94,
  'Bosnia and Herzegovina': 58.35,
  'Turkey': 58.75,
  'North Macedonia': 58.86,
  'Kosovo': 59.20,
  'Vietnam': 59.20,
  'Jordan': 60.01,
  'Germany': 60.61,
  'Russia': 61.32,
  'Thailand': 62.67,
  'Serbia': 62.83,
  'Latvia': 62.87,
  'Nepal': 63.32,
  'Spain': 63.42,
  'Bulgaria': 63.87,
  'Montenegro': 64.59,
  'Cuba': 65.61,
  'Luxembourg': 65.81,
  'Hungary': 66.30,
  'Cyprus': 66.92,
  'Norway': 66.98,
  'Kuwait': 67.19,
  'Lithuania': 67.63,
  'Romania': 67.68,
  'Portugal': 67.94,
  'Azerbaijan': 68.22,
  'Israel': 68.25,
  'Slovakia': 69.05,
  'Austria': 70.46,
  'Brunei': 70.70,
  'Poland': 70.96,
  'Uzbekistan': 72.11,
  'Rwanda': 73.07,
  'Netherlands': 73.09,
  'Finland': 73.24,
  'Czechia': 73.53,
  'Switzerland': 73.53,
  'Georgia': 73.71,
  'Denmark': 73.96,
  'Iceland': 74.26,
  'Croatia': 74.53,
  'South Korea': 75.08,
  'Bahrain': 75.45,
  'China': 75.98,
  'Saudi Arabia': 76.05,
  'Slovenia': 76.20,
  'Estonia': 76.34,
  'Monaco': 76.67,
  'Japan': 77.13,
  'Singapore': 77.40,
  'Armenia': 77.91,
  'Hong Kong': 78.46,
  'Oman': 81.69,
  'Taiwan': 82.92,
  'Qatar': 84.21,
  'United Arab Emirates': 84.51,
  'Andorra': 84.71,
}

// PISA Math Scores 2022
const pisaMath: Record<string, number> = {
  'Singapore': 575,
  'China': 552,
  'Taiwan': 547,
  'Hong Kong': 540,
  'Japan': 536,
  'South Korea': 527,
  'Estonia': 510,
  'Switzerland': 508,
  'Canada': 497,
  'Netherlands': 493,
  'Ireland': 492,
  'United Kingdom': 489,
  'Poland': 489,
  'Belgium': 489,
  'Denmark': 489,
  'Australia': 487,
  'Czechia': 487,
  'Austria': 487,
  'Slovenia': 485,
  'Finland': 484,
  'Latvia': 483,
  'Sweden': 482,
  'New Zealand': 479,
  'Germany': 475,
  'Lithuania': 475,
  'France': 474,
  'Spain': 473,
  'Hungary': 473,
  'Portugal': 472,
  'Italy': 471,
  'Vietnam': 469,
  'Norway': 468,
  'Malta': 466,
  'United States': 465,
  'Slovakia': 464,
  'Croatia': 463,
  'Iceland': 459,
  'Israel': 458,
  'Turkey': 453,
  'Brunei': 442,
  'Ukraine': 441,
  'Serbia': 440,
  'United Arab Emirates': 431,
  'Greece': 430,
  'Romania': 428,
  'Kazakhstan': 425,
  'Mongolia': 425,
  'Cyprus': 418,
  'Bulgaria': 417,
  'Qatar': 414,
  'Moldova': 414,
  'Chile': 412,
  'Malaysia': 409,
  'Uruguay': 409,
  'Montenegro': 406,
  'Azerbaijan': 397,
  'Mexico': 395,
  'Thailand': 394,
  'Peru': 391,
  'Georgia': 390,
  'Saudi Arabia': 389,
  'North Macedonia': 389,
  'Costa Rica': 385,
  'Colombia': 383,
  'Brazil': 379,
  'Argentina': 378,
  'Jamaica': 377,
  'Albania': 368,
  'Indonesia': 366,
  'Palestine': 366,
  'Morocco': 365,
  'Uzbekistan': 364,
  'Jordan': 361,
  'Panama': 357,
  'Philippines': 355,
  'Guatemala': 344,
  'El Salvador': 343,
  'Dominican Republic': 339,
  'Paraguay': 338,
  'Cambodia': 336,
}

// Startup Unicorns by country (2025)
const startupUnicorns: Record<string, number> = {
  'United States': 712,
  'China': 157,
  'India': 69,
  'United Kingdom': 55,
  'Germany': 32,
  'France': 29,
  'Israel': 25,
  'Canada': 22,
  'Brazil': 18,
  'South Korea': 14,
  'Singapore': 14,
  'Mexico': 9,
  'Japan': 9,
  'Australia': 9,
  'Netherlands': 9,
  'Ireland': 9,
  'Indonesia': 7,
  'Hong Kong': 7,
  'Sweden': 6,
  'Switzerland': 6,
  'Spain': 5,
  'United Arab Emirates': 5,
  'Norway': 5,
  'Colombia': 4,
  'Finland': 4,
  'Italy': 3,
  'Belgium': 3,
  'Nigeria': 2,
  'Vietnam': 2,
  'Thailand': 2,
  'Chile': 2,
  'Greece': 2,
  'Austria': 2,
  'Denmark': 2,
  'Croatia': 2,
  'Lithuania': 2,
  'Estonia': 2,
  'Egypt': 1,
  'Philippines': 1,
  'Turkey': 1,
  'South Africa': 1,
  'Argentina': 1,
  'Uzbekistan': 1,
  'Malaysia': 1,
  'Saudi Arabia': 1,
  'Senegal': 1,
  'Ecuador': 1,
  'Czechia': 1,
  'Portugal': 1,
  'New Zealand': 1,
  'Luxembourg': 1,
  'Malta': 1,
}

// Millionaires per 1000 adults (UBS 2025)
const millionairesPerCapita: Record<string, number> = {
  'Switzerland': 145.6,
  'Hong Kong': 96.1,
  'Australia': 85.2,
  'United States': 84.8,
  'Singapore': 80.0,
  'Netherlands': 75.0,
  'Belgium': 70.0,
  'Denmark': 65.0,
  'New Zealand': 62.0,
  'Canada': 60.0,
  'Sweden': 58.0,
  'Taiwan': 55.0,
  'United Kingdom': 49.0,
  'France': 47.0,
  'Norway': 46.0,
  'Germany': 45.0,
  'Austria': 43.0,
  'Ireland': 42.0,
  'Japan': 40.0,
  'Italy': 35.0,
  'South Korea': 32.0,
  'Israel': 30.0,
  'Spain': 25.0,
  'China': 8.0,
  'Russia': 3.6,
  'Brazil': 2.5,
  'Mexico': 2.0,
  'India': 0.8,
  'Indonesia': 0.5,
  'South Africa': 4.0,
  'Saudi Arabia': 15.0,
  'United Arab Emirates': 35.0,
  'Qatar': 40.0,
  'Kuwait': 25.0,
  'Bahrain': 20.0,
  'Luxembourg': 155.0,
  'Monaco': 170.0,
  'Portugal': 18.0,
  'Poland': 5.0,
  'Czechia': 6.0,
  'Hungary': 4.0,
  'Greece': 8.0,
  'Turkey': 2.5,
  'Thailand': 2.0,
  'Malaysia': 3.5,
  'Philippines': 0.8,
  'Vietnam': 0.5,
  'Argentina': 1.5,
  'Chile': 5.0,
  'Colombia': 1.0,
  'Peru': 0.8,
}

// Urban population percentage (2024)
const urbanPopulation: Record<string, number> = {
  'Singapore': 100,
  'Hong Kong': 100,
  'Kuwait': 100,
  'Monaco': 100,
  'Macao': 100,
  'Qatar': 99.39,
  'Belgium': 98.22,
  'San Marino': 97.93,
  'Uruguay': 95.85,
  'Malta': 95.01,
  'Iceland': 94.09,
  'Puerto Rico': 93.66,
  'Netherlands': 93.45,
  'Israel': 92.95,
  'Argentina': 92.58,
  'Luxembourg': 92.27,
  'Jordan': 92.21,
  'Japan': 92.13,
  'Gabon': 91.31,
  'Bahrain': 90,
  'Lebanon': 89.6,
  'Oman': 89,
  'Sweden': 88.98,
  'Denmark': 88.63,
  'Venezuela': 88.5,
  'Chile': 88.12,
  'Brazil': 88.02,
  'United Arab Emirates': 88.01,
  'Andorra': 87.75,
  'New Zealand': 87.09,
  'Australia': 86.75,
  'Finland': 85.87,
  'Saudi Arabia': 85.17,
  'Dominican Republic': 85.01,
  'United Kingdom': 84.88,
  'Norway': 84.32,
  'Bahamas': 83.76,
  'United States': 83.51,
  'Costa Rica': 83.17,
  'Colombia': 82.65,
  'France': 82.04,
  'Canada': 81.98,
  'Libya': 81.91,
  'Mexico': 81.86,
  'Spain': 81.8,
  'South Korea': 81.5,
  'Belarus': 81.13,
  'Greece': 80.98,
  'Brunei': 79.44,
  'Malaysia': 79.2,
  'Peru': 79.14,
  'Djibouti': 78.73,
  'Germany': 77.89,
  'Turkey': 77.89,
  'Palestine': 77.88,
  'Iran': 77.7,
  'Bulgaria': 77.04,
  'El Salvador': 76,
  'Algeria': 75.75,
  'Russia': 75.55,
  'Equatorial Guinea': 74.87,
  'Czechia': 74.74,
  'Switzerland': 74.33,
  'Botswana': 73.49,
  'Hungary': 73.18,
  'Italy': 72.29,
  'Iraq': 71.85,
  'Bolivia': 71.54,
  'Tunisia': 70.88,
  'Ukraine': 70.28,
  'Estonia': 70.02,
  'Panama': 69.89,
  'Republic of the Congo': 69.64,
  'South Africa': 69.3,
  'Angola': 69.28,
  'Mongolia': 69.26,
  'Lithuania': 68.94,
  'Montenegro': 68.84,
  'Latvia': 68.82,
  'Portugal': 68.42,
  'Cabo Verde': 68.41,
  'Cyprus': 67.08,
  'Suriname': 66.53,
  'Morocco': 65.64,
  'China': 65.54,
  'Albania': 65.38,
  'Gambia': 65.08,
  'Ecuador': 65.03,
  'Ireland': 64.76,
  'Armenia': 63.93,
  'North Korea': 63.5,
  'Paraguay': 63.49,
  'Georgia': 61.16,
  'Honduras': 60.82,
  'Haiti': 60.47,
  'Poland': 60.33,
  'Nicaragua': 60.15,
  'Cameroon': 59.89,
  'North Macedonia': 59.87,
  'Ghana': 59.85,
  'Austria': 59.82,
  'Indonesia': 59.2,
  'Fiji': 59.19,
  'Croatia': 58.94,
  'Mauritania': 58.46,
  'Kazakhstan': 58.39,
  'Syria': 58.04,
  'Azerbaijan': 58,
  'Jamaica': 57.76,
  'Serbia': 57.37,
  'Slovenia': 56.44,
  'Namibia': 55.79,
  'Nigeria': 55.03,
  'Romania': 54.88,
  'Turkmenistan': 54.52,
  'Thailand': 54.32,
  'Slovakia': 54.17,
  'Liberia': 54.08,
  "Cote d'Ivoire": 53.64,
  'Trinidad and Tobago': 53.56,
  'Guatemala': 53.54,
  'Bosnia and Herzegovina': 50.71,
  'Benin': 50.67,
  'Uzbekistan': 50.63,
  'Senegal': 50.08,
  'Philippines': 48.61,
  'Somalia': 48.52,
  'Democratic Republic of the Congo': 48.06,
  'Mali': 46.93,
  'Zambia': 46.91,
  'Belize': 46.84,
  'Guinea-Bissau': 45.89,
  'Togo': 45.06,
  'Bhutan': 45,
  'Sierra Leone': 44.78,
  'Central African Republic': 44.13,
  'Eritrea': 43.91,
  'Moldova': 43.6,
  'Egypt': 43.26,
  'Maldives': 42.41,
  'Bangladesh': 41.23,
  'Madagascar': 41.23,
  'Mauritius': 40.94,
  'Yemen': 40.48,
  'Vietnam': 40.19,
  'Mozambique': 39.33,
  'Laos': 38.91,
  'Guinea': 38.52,
  'Pakistan': 38.37,
  'Kyrgyzstan': 38.17,
  'Tanzania': 38.14,
  'India': 36.87,
  'Sudan': 36.75,
  'Burkina Faso': 33.17,
  'Zimbabwe': 32.67,
  'Myanmar': 32.47,
  'Barbados': 31.55,
  'Lesotho': 30.9,
  'Comoros': 30.42,
  'Kenya': 30.05,
  'Tajikistan': 28.52,
  'Uganda': 27.39,
  'Guyana': 27.32,
  'Afghanistan': 27.26,
  'Solomon Islands': 26.49,
  'Cambodia': 26.03,
  'Eswatini': 25.01,
  'Chad': 24.69,
  'Ethiopia': 23.66,
  'Nepal': 22.37,
  'Sri Lanka': 19.42,
  'Malawi': 18.6,
  'Rwanda': 18.08,
  'Niger': 17.23,
  'Burundi': 15.16,
  'Papua New Guinea': 13.88,
}

// Median age data (2024)
const medianAge: Record<string, number> = {
  'Japan': 49.38,
  'Italy': 47.85,
  'Hong Kong': 46.78,
  'Portugal': 46.58,
  'Greece': 46.27,
  'Spain': 45.39,
  'Bosnia and Herzegovina': 45.30,
  'Germany': 45.29,
  'South Korea': 45.05,
  'Croatia': 44.98,
  'Slovenia': 44.78,
  'Bulgaria': 44.57,
  'Austria': 44.17,
  'Finland': 43.68,
  'Cuba': 43.59,
  'Serbia': 43.55,
  'Switzerland': 43.51,
  'Belgium': 42.59,
  'Lithuania': 42.53,
  'Romania': 42.44,
  'Netherlands': 42.41,
  'France': 42.28,
  'Canada': 41.62,
  'Hungary': 41.41,
  'Denmark': 41.40,
  'Montenegro': 41.30,
  'Latvia': 41.26,
  'Ukraine': 41.24,
  'Poland': 41.10,
  'United Kingdom': 40.90,
  'Czechia': 40.90,
  'Taiwan': 40.75,
  'Sweden': 40.57,
  'Estonia': 40.45,
  'Slovakia': 40.26,
  'China': 40.11,
  'Thailand': 40.55,
  'Norway': 39.77,
  'Russia': 39.67,
  'Ireland': 39.44,
  'North Macedonia': 39.14,
  'Moldova': 38.85,
  'United States': 38.50,
  'Australia': 38.26,
  'New Zealand': 37.94,
  'Albania': 37.67,
  'Georgia': 37.31,
  'Singapore': 37.28,
  'Brazil': 34.82,
  'Argentina': 33.08,
  'Chile': 35.85,
  'Colombia': 32.22,
  'Costa Rica': 34.52,
  'Tunisia': 33.48,
  'Mexico': 29.62,
  'Turkey': 33.47,
  'Vietnam': 32.62,
  'Morocco': 30.82,
  'Indonesia': 30.82,
  'India': 28.83,
  'Malaysia': 30.71,
  'Sri Lanka': 35.22,
  'Iran': 33.66,
  'Saudi Arabia': 31.80,
  'United Arab Emirates': 36.74,
  'South Africa': 28.26,
  'Myanmar': 30.23,
  'Philippines': 25.75,
  'Egypt': 24.62,
  'Pakistan': 22.53,
  'Bangladesh': 28.12,
  'Iraq': 21.51,
  'Afghanistan': 18.43,
  'Ethiopia': 19.78,
  'Nigeria': 18.14,
  'Kenya': 20.03,
  'Tanzania': 18.04,
  'Uganda': 16.45,
  'Niger': 15.40,
  'Mali': 16.35,
  'Chad': 17.49,
  'Central African Republic': 14.48,
  'Somalia': 15.58,
}

// Update function
function updateData() {
  let updatedCount = 0

  countriesData.forEach((country: any) => {
    const name = country.name

    // Initialize missing objects
    if (!country.crime) country.crime = {}
    if (!country.education) country.education = {}
    if (!country.economy) country.economy = {}
    if (!country.demographics) country.demographics = {}

    // Update homicide rate
    if (homicideRates[name] !== undefined && (country.crime.homicideRate === null || country.crime.homicideRate === undefined)) {
      country.crime.homicideRate = homicideRates[name]
      console.log(`Updated homicideRate for ${name}: ${homicideRates[name]}`)
      updatedCount++
    }

    // Update safety index
    if (safetyIndex[name] !== undefined && (country.crime.safetyIndex === null || country.crime.safetyIndex === undefined)) {
      country.crime.safetyIndex = safetyIndex[name]
      console.log(`Updated safetyIndex for ${name}: ${safetyIndex[name]}`)
      updatedCount++
    }

    // Update PISA math
    if (pisaMath[name] !== undefined && (country.education.pisaMath === null || country.education.pisaMath === undefined)) {
      country.education.pisaMath = pisaMath[name]
      console.log(`Updated pisaMath for ${name}: ${pisaMath[name]}`)
      updatedCount++
    }

    // Update startup unicorns
    if (startupUnicorns[name] !== undefined) {
      country.economy.startupUnicorns = startupUnicorns[name]
      console.log(`Updated startupUnicorns for ${name}: ${startupUnicorns[name]}`)
      updatedCount++
    }

    // Update millionaires per capita
    if (millionairesPerCapita[name] !== undefined) {
      country.economy.millionairesPerCapita = millionairesPerCapita[name]
      console.log(`Updated millionairesPerCapita for ${name}: ${millionairesPerCapita[name]}`)
      updatedCount++
    }

    // Update urban population
    if (urbanPopulation[name] !== undefined && (country.demographics.urbanPopulation === null || country.demographics.urbanPopulation === undefined)) {
      country.demographics.urbanPopulation = urbanPopulation[name]
      console.log(`Updated urbanPopulation for ${name}: ${urbanPopulation[name]}`)
      updatedCount++
    }

    // Update median age
    if (medianAge[name] !== undefined && (country.demographics.medianAge === null || country.demographics.medianAge === undefined)) {
      country.demographics.medianAge = medianAge[name]
      console.log(`Updated medianAge for ${name}: ${medianAge[name]}`)
      updatedCount++
    }
  })

  console.log(`\nTotal fields updated: ${updatedCount}`)

  // Write updated data
  fs.writeFileSync('data/countries.json', JSON.stringify(countriesData, null, 2))
  console.log('Data written to countries.json')
}

updateData()
